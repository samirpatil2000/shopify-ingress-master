function triggerCheckout(payload) {
  var ifrm = document.createElement("iframe");
  ifrm.id = "growwx-iframe";
  ifrm.setAttribute("src", getIframeUrl(payload));
  if (isMobile()) {
    console.log("Mobile");
    ifrm.style.width = "100%";
    ifrm.style.height = "100%";
    ifrm.style.border = "none";
    ifrm.allowFullscreen = true;
    ifrm.style.position = "fixed";
    ifrm.style.top = "0px";
    ifrm.style.left = "0px";
    ifrm.style.bottom = "0px";
    ifrm.style.right = "0px";
    ifrm.style.overflow = "unset";
    ifrm.style.zIndex = "9999999999";
  } else {
    console.log("Desktop view not supported");
  }
  document.body.appendChild(ifrm);
  document.body.style.overflow = "hidden";
  window.addEventListener("message", function (e) {
    if (e.data && e.data.event === "unload-iframe") {
      var iframe = document.getElementById("growwx-iframe");
      iframe.parentNode.removeChild(iframe);
      document.body.style.overflow = "auto";
    }
    if (e.data && e.data.event === "navigate") {
      this.window.location.replace(e.data.location);
    }
    if (e.data && e.data.event === "setItem") {
      this.localStorage.setItem(e.data.key, e.data.value);
    }
    if (e.data && e.data.event === "removeItem") {
      this.localStorage.removeItem(e.data.key);
    }
  });
  ifrm.onload = function () {
    publishLocalStorage();
  };
}

function publishLocalStorage() {
  console.log("publishLocalStorage");
  var localStorageMap = {};
  for (var i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    localStorageMap[key] = localStorage.getItem(key);
  }
  var iframe = document.getElementById("growwx-iframe");
  iframe.contentWindow.postMessage(
    { event: "storageSync", dataMap: localStorageMap },
    "*"
  );
}

function isMobile() {
  return screen.width <= 480;
}



function getPayload1() {
  const prev = "eyJjYXJ0Ijp7InRvdGFsX3ByaWNlIjoxLCJ0b3RhbF9kaXNjb3VudCI6MCwiaXRlbV9jb3VudCI6MSwiaXRlbXMiOlt7ImlkIjoiNzg0ODA4OTY0OTM5OCIsInF1YW50aXR5IjoxLCJ2YXJpYW50X2lkIjoiNDQ0NTk2MjM3NzY1MDIiLCJ0aXRsZSI6IlByb2R1Y3QtMiIsInByaWNlIjoxLCJvcmlnaW5hbF9wcmljZSI6MSwiZGlzY291bnRlZF9wcmljZSI6MSwidG90YWxfZGlzY291bnQiOjAsImRpc2NvdW50cyI6W10sInNrdSI6Ijg5MDQxMzA4OTc5NTUiLCJ1cmwiOiIvcHJvZHVjdHMvcHJvZHVjdC0yIiwiaW1hZ2UiOiJodHRwczovL2Nkbi5zaG9waWZ5LmNvbS9zL2ZpbGVzLzEvMDY2Ni84NDU1LzE0MTQvcHJvZHVjdHMvNjF5QkNNbXVJNEwuX1VMMTQ0MC5qcGcifV0sInJlcXVpcmVzX3NoaXBwaW5nIjp0cnVlLCJjdXJyZW5jeSI6IklOUiIsIml0ZW1zX3N1YnRvdGFsX3ByaWNlIjoxLCJjYXJ0X2xldmVsX2Rpc2NvdW50X2FwcGxpY2F0aW9ucyI6W119LCJtaWQiOiIxNzY5Y2RhYy0xOGEzLTRhZDctYWI3MS1hMjZlNWQ2M2ViOGEifQ==";
  const current = "ewogICAgImNhcnQiOiB7CiAgICAgICAgInRvdGFsX3ByaWNlIjogMiwKICAgICAgICAidG90YWxfZGlzY291bnQiOiAwLAogICAgICAgICJpdGVtX2NvdW50IjogMSwKICAgICAgICAiaXRlbXMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJpZCI6IDQzOTQ5Nzg3NzQyNDMwLAogICAgICAgICAgICAgICAgInF1YW50aXR5IjogMSwKICAgICAgICAgICAgICAgICJ2YXJpYW50X2lkIjogNDM5NDk3ODc3NDI0MzAsCiAgICAgICAgICAgICAgICAidGl0bGUiOiAiQXJ0aWZpY2lhbCBmbG93ZXIgLSBBbXV5YSIsCiAgICAgICAgICAgICAgICAicHJpY2UiOiAyLAogICAgICAgICAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogMiwKICAgICAgICAgICAgICAgICJkaXNjb3VudGVkX3ByaWNlIjogMiwKICAgICAgICAgICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgICAgICAgICAiZGlzY291bnRzIjogW10sCiAgICAgICAgICAgICAgICAic2t1IjogIiIsCiAgICAgICAgICAgICAgICAiZ3JhbXMiOiAyMDAsCiAgICAgICAgICAgICAgICAidXJsIjogImh0dHBzOi8vY2RuLnNob3BpZnkuY29tL3MvZmlsZXMvMS8wNjY0LzE1MTYvNTY2Mi9wcm9kdWN0cy9GbG93ZXItYXJ0aWZpY2lhbC5qcGc/dj0xNjc1MDc5NDI3IiwKICAgICAgICAgICAgICAgICJpbWFnZSI6ICJodHRwczovL2Nkbi5zaG9waWZ5LmNvbS9zL2ZpbGVzLzEvMDY2NC8xNTE2LzU2NjIvcHJvZHVjdHMvRmxvd2VyLWFydGlmaWNpYWwuanBnP3Y9MTY3NTA3OTQyNyIKICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgInJlcXVpcmVzX3NoaXBwaW5nIjogdHJ1ZSwKICAgICAgICAiY3VycmVuY3kiOiAiSU5SIiwKICAgICAgICAiaXRlbXNfc3VidG90YWxfcHJpY2UiOiAyLAogICAgICAgICJjYXJ0X2xldmVsX2Rpc2NvdW50X2FwcGxpY2F0aW9ucyI6IFtdCiAgICB9LAogICAgIm1pZCI6ICI2MTg5NGI2Yy0xNTg0LTRmMjItODFiOS05NTdjMGU4NTA0YzMiCn0="
  return current
}

function newPayload8_5() {
  return "ewogICJjYXJ0IjogewogICAgInRvdGFsX3ByaWNlIjogOSwKICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAiaXRlbV9jb3VudCI6IDMsCiAgICAiaXRlbXMiOiBbCiAgICAgIHsKICAgICAgICAiaWQiOiA0MzgyNTAxMDgwMjkxMCwKICAgICAgICAicXVhbnRpdHkiOiAxLAogICAgICAgICJ2YXJpYW50X2lkIjogNDM4MjUwMTA4MDI5MTAsCiAgICAgICAgInRpdGxlIjogIlB1cnBsZSBGbG93ZXIiLAogICAgICAgICJwcmljZSI6IDUsCiAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogNSwKICAgICAgICAiZGlzY291bnRlZF9wcmljZSI6IDUsCiAgICAgICAgInRvdGFsX2Rpc2NvdW50IjogMCwKICAgICAgICAiZGlzY291bnRzIjogW10sCiAgICAgICAgInNrdSI6ICIiLAogICAgICAgICJncmFtcyI6IDEwMCwKICAgICAgICAidXJsIjogImh0dHBzOi8vY2RuLnNob3BpZnkuY29tL3MvZmlsZXMvMS8wNjY0LzE1MTYvNTY2Mi9wcm9kdWN0cy9wdXJwbGUtb3N0ZW9zcGVybXVtLWRhaXN5LWZsb3dlcl8xMzczLTE2LndlYnA/dj0xNjcyMzIxODUyIiwKICAgICAgICAiaW1hZ2UiOiAiaHR0cHM6Ly9jZG4uc2hvcGlmeS5jb20vcy9maWxlcy8xLzA2NjQvMTUxNi81NjYyL3Byb2R1Y3RzL3B1cnBsZS1vc3Rlb3NwZXJtdW0tZGFpc3ktZmxvd2VyXzEzNzMtMTYud2VicD92PTE2NzIzMjE4NTIiCiAgICAgIH0sCiAgICAgIHsKICAgICAgICAiaWQiOiA0MzcxNDQ4MzA5MzcyNiwKICAgICAgICAicXVhbnRpdHkiOiAyLAogICAgICAgICJ2YXJpYW50X2lkIjogNDM3MTQ0ODMwOTM3MjYsCiAgICAgICAgInRpdGxlIjogIkFydGlmaWNpYWwgZmxvd2VyIC0gRXhvdGljYSIsCiAgICAgICAgInByaWNlIjogMiwKICAgICAgICAib3JpZ2luYWxfcHJpY2UiOiAyLAogICAgICAgICJkaXNjb3VudGVkX3ByaWNlIjogMiwKICAgICAgICAidG90YWxfZGlzY291bnQiOiAwLAogICAgICAgICJkaXNjb3VudHMiOiBbXSwKICAgICAgICAic2t1IjogIjEyMjIiLAogICAgICAgICJncmFtcyI6IDIwMCwKICAgICAgICAidXJsIjogImh0dHBzOi8vY2RuLnNob3BpZnkuY29tL3MvZmlsZXMvMS8wNjY0LzE1MTYvNTY2Mi9wcm9kdWN0cy9hcnRpZmljaWFsZmxvd2VyLmpwZz92PTE2NzUwNzkzNzkiLAogICAgICAgICJpbWFnZSI6ICJodHRwczovL2Nkbi5zaG9waWZ5LmNvbS9zL2ZpbGVzLzEvMDY2NC8xNTE2LzU2NjIvcHJvZHVjdHMvYXJ0aWZpY2lhbGZsb3dlci5qcGc/dj0xNjc1MDc5Mzc5IgogICAgICB9CiAgICBdLAogICAgInJlcXVpcmVzX3NoaXBwaW5nIjogdHJ1ZSwKICAgICJjdXJyZW5jeSI6ICJJTlIiLAogICAgIml0ZW1zX3N1YnRvdGFsX3ByaWNlIjogOSwKICAgICJjYXJ0X2xldmVsX2Rpc2NvdW50X2FwcGxpY2F0aW9ucyI6IFtdCiAgfSwKICAibWlkIjogIjYxODk0YjZjLTE1ODQtNGYyMi04MWI5LTk1N2MwZTg1MDRjMyIKfQ=="
}

const payloadFlaars100 = "ewogICAgImNhcnQiOiB7CiAgICAgICAgInRvdGFsX3ByaWNlIjogMTAwLAogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgIml0ZW1fY291bnQiOiAxLAogICAgICAgICJpdGVtcyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgImlkIjogIjc4OTI0MDUxMjUzNDIiLAogICAgICAgICAgICAgICAgInF1YW50aXR5IjogMSwKICAgICAgICAgICAgICAgICJ2YXJpYW50X2lkIjogIjQzNzE0NDgzMDkzNzI2IiwKICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJBcnRpZmljaWFsIGZsb3dlciAtIEV4b3RpY2EiLAogICAgICAgICAgICAgICAgInByaWNlIjogMTAwLAogICAgICAgICAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogMTAwLAogICAgICAgICAgICAgICAgImRpc2NvdW50ZWRfcHJpY2UiOiAxMDAsCiAgICAgICAgICAgICAgICAidG90YWxfZGlzY291bnQiOiAwLAogICAgICAgICAgICAgICAgImRpc2NvdW50cyI6IFtdLAogICAgICAgICAgICAgICAgInNrdSI6ICI4OTA0MTMwODk3OTU1IiwKICAgICAgICAgICAgICAgICJ1cmwiOiAiL3Byb2R1Y3RzL2FydGlmaWNpYWwtZmxvd2VyLWV4b3RpY2EiLAogICAgICAgICAgICAgICAgImltYWdlIjogImh0dHBzOi8vY2RuLnNob3BpZnkuY29tL3MvZmlsZXMvMS8wNjY0LzE1MTYvNTY2Mi9wcm9kdWN0cy9hcnRpZmljaWFsZmxvd2VyLmpwZyIKICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgInJlcXVpcmVzX3NoaXBwaW5nIjogdHJ1ZSwKICAgICAgICAiY3VycmVuY3kiOiAiSU5SIiwKICAgICAgICAiaXRlbXNfc3VidG90YWxfcHJpY2UiOiAxMDAsCiAgICAgICAgImNhcnRfbGV2ZWxfZGlzY291bnRfYXBwbGljYXRpb25zIjogW10KICAgIH0sCiAgICAibWlkIjogIjYxODk0YjZjLTE1ODQtNGYyMi04MWI5LTk1N2MwZTg1MDRjMyIKfQ=="

const payloadFlaars2 = "ewogICAgImNhcnQiOiB7CiAgICAgICAgInRvdGFsX3ByaWNlIjogMiwKICAgICAgICAidG90YWxfZGlzY291bnQiOiAwLAogICAgICAgICJpdGVtX2NvdW50IjogMSwKICAgICAgICAiaXRlbXMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJpZCI6IDQzODI1MDEwODAyOTEwLAogICAgICAgICAgICAgICAgInF1YW50aXR5IjogMSwKICAgICAgICAgICAgICAgICJ2YXJpYW50X2lkIjogNDM4MjUwMTA4MDI5MTAsCiAgICAgICAgICAgICAgICAidGl0bGUiOiAiUHVycGxlIEZsb3dlciIsCiAgICAgICAgICAgICAgICAicHJpY2UiOiAyLAogICAgICAgICAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogMiwKICAgICAgICAgICAgICAgICJkaXNjb3VudGVkX3ByaWNlIjogMiwKICAgICAgICAgICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgICAgICAgICAiZGlzY291bnRzIjogW10sCiAgICAgICAgICAgICAgICAic2t1IjogIiIsCiAgICAgICAgICAgICAgICAiZ3JhbXMiOiAxMDAsCiAgICAgICAgICAgICAgICAidXJsIjogImh0dHBzOi8vY2RuLnNob3BpZnkuY29tL3MvZmlsZXMvMS8wNjY0LzE1MTYvNTY2Mi9wcm9kdWN0cy9wdXJwbGUtb3N0ZW9zcGVybXVtLWRhaXN5LWZsb3dlcl8xMzczLTE2LndlYnA/dj0xNjcyMzIxODUyIiwKICAgICAgICAgICAgICAgICJpbWFnZSI6ICJodHRwczovL2Nkbi5zaG9waWZ5LmNvbS9zL2ZpbGVzLzEvMDY2NC8xNTE2LzU2NjIvcHJvZHVjdHMvcHVycGxlLW9zdGVvc3Blcm11bS1kYWlzeS1mbG93ZXJfMTM3My0xNi53ZWJwP3Y9MTY3MjMyMTg1MiIKICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgInJlcXVpcmVzX3NoaXBwaW5nIjogdHJ1ZSwKICAgICAgICAiY3VycmVuY3kiOiAiSU5SIiwKICAgICAgICAiaXRlbXNfc3VidG90YWxfcHJpY2UiOiAyLAogICAgICAgICJjYXJ0X2xldmVsX2Rpc2NvdW50X2FwcGxpY2F0aW9ucyI6IFtdCiAgICB9LAogICAgIm1pZCI6ICI2MTg5NGI2Yy0xNTg0LTRmMjItODFiOS05NTdjMGU4NTA0YzMiCn0="


const payloadAartzy200 = "eyJjYXJ0Ijp7InRvdGFsX3ByaWNlIjo5MDAsInRvdGFsX2Rpc2NvdW50IjowLCJpdGVtX2NvdW50IjoxLCJpdGVtcyI6W3siaWQiOiI4MDY3MzYxOTMxNTgxIiwicXVhbnRpdHkiOjEsInZhcmlhbnRfaWQiOiI0NDMzMjQ2NzI1NzY2MSIsInRpdGxlIjoiQnJhc3MgSGFtbWVyZWQgUGxhbnRlciIsInByaWNlIjo5MDAsIm9yaWdpbmFsX3ByaWNlIjo5MDAsImRpc2NvdW50ZWRfcHJpY2UiOjkwMCwidG90YWxfZGlzY291bnQiOjAsImRpc2NvdW50cyI6W10sInNrdSI6Ijg5MDQxMzA4OTc5NTUiLCJ1cmwiOiIvcHJvZHVjdHMvYnJhc3MtaGFtbWVyZWQtcGxhbnRlciIsImltYWdlIjoiaHR0cHM6Ly9jZG4uc2hvcGlmeS5jb20vcy9maWxlcy8xLzA3MDEvMjY1Ni83NzQxL3Byb2R1Y3RzL2FwN3N1LTl2ZGMyLmpwZyJ9XSwicmVxdWlyZXNfc2hpcHBpbmciOnRydWUsImN1cnJlbmN5IjoiSU5SIiwiaXRlbXNfc3VidG90YWxfcHJpY2UiOjkwMCwiY2FydF9sZXZlbF9kaXNjb3VudF9hcHBsaWNhdGlvbnMiOltdfSwibWlkIjoiNTRkMWJiYTctOTExNC00YmViLTlmMzQtYWQ3NGM5NDI5OGNmIn0="

const payloadAartzy2 = "ewogICJjYXJ0IjogewogICAgInRvdGFsX3ByaWNlIjogMiwKICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAiaXRlbV9jb3VudCI6IDEsCiAgICAiaXRlbXMiOiBbCiAgICAgIHsKICAgICAgICAiaWQiOiAiODA2NzM2MTkzMTU4MSIsCiAgICAgICAgInF1YW50aXR5IjogMSwKICAgICAgICAidmFyaWFudF9pZCI6ICI0NDMzMjQ2NzI1NzY2MSIsCiAgICAgICAgInRpdGxlIjogIkJyYXNzIEhhbW1lcmVkIFBsYW50ZXIiLAogICAgICAgICJwcmljZSI6IDIsCiAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogMiwKICAgICAgICAiZGlzY291bnRlZF9wcmljZSI6IDIsCiAgICAgICAgInRvdGFsX2Rpc2NvdW50IjogMCwKICAgICAgICAiZGlzY291bnRzIjogW10sCiAgICAgICAgInNrdSI6ICI4OTA0MTMwODk3OTU1IiwKICAgICAgICAidXJsIjogIi9wcm9kdWN0cy9icmFzcy1oYW1tZXJlZC1wbGFudGVyIiwKICAgICAgICAiaW1hZ2UiOiAiaHR0cHM6Ly9jZG4uc2hvcGlmeS5jb20vcy9maWxlcy8xLzA3MDEvMjY1Ni83NzQxL3Byb2R1Y3RzL2FwN3N1LTl2ZGMyLmpwZyIKICAgICAgfQogICAgXSwKICAgICJyZXF1aXJlc19zaGlwcGluZyI6IHRydWUsCiAgICAiY3VycmVuY3kiOiAiSU5SIiwKICAgICJpdGVtc19zdWJ0b3RhbF9wcmljZSI6IDIsCiAgICAiY2FydF9sZXZlbF9kaXNjb3VudF9hcHBsaWNhdGlvbnMiOiBbXQogIH0sCiAgIm1pZCI6ICI1NGQxYmJhNy05MTE0LTRiZWItOWYzNC1hZDc0Yzk0Mjk4Y2YiCn0="


function checkoutOnFlaars(){
  triggerCheckout(payloadFlaars2)
}


function checkoutOnAartzy(){
  triggerCheckout(payloadAartzy2)
}


function getIframeUrl(payload) {
  const NGROK = "https://10a3-175-100-183-105.ngrok.io"
  const LOCALHOST = "http://localhost:3000"
  return NGROK + "/?payload=" + payload;
}